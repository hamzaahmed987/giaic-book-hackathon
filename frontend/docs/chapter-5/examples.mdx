---
sidebar_position: 3
title: "Practical Examples"
description: Building AI agents with tools
---

# Practical Examples

## Example 1: Research Agent

```python
from openai import OpenAI
import json

client = OpenAI()

# Define tools
tools = [
    {
        "type": "function",
        "function": {
            "name": "search_papers",
            "description": "Search for academic papers on a topic",
            "parameters": {
                "type": "object",
                "properties": {
                    "query": {"type": "string"},
                    "max_results": {"type": "integer", "default": 5}
                },
                "required": ["query"]
            }
        }
    },
    {
        "type": "function",
        "function": {
            "name": "summarize_paper",
            "description": "Get a summary of a specific paper",
            "parameters": {
                "type": "object",
                "properties": {
                    "paper_id": {"type": "string"}
                },
                "required": ["paper_id"]
            }
        }
    }
]

def research_agent(question: str):
    messages = [
        {"role": "system", "content": "You are a research assistant. Use the available tools to find and summarize relevant papers."},
        {"role": "user", "content": question}
    ]

    while True:
        response = client.chat.completions.create(
            model="gpt-4-turbo",
            messages=messages,
            tools=tools
        )

        message = response.choices[0].message

        if message.tool_calls:
            messages.append(message)

            for tool_call in message.tool_calls:
                result = execute_tool(tool_call)
                messages.append({
                    "role": "tool",
                    "tool_call_id": tool_call.id,
                    "content": result
                })
        else:
            return message.content

# Usage
result = research_agent("What are the latest advances in RAG systems?")
print(result)
```

## Example 2: Code Execution Agent

```python
class CodeAgent:
    def __init__(self):
        self.client = OpenAI()
        self.tools = [{
            "type": "function",
            "function": {
                "name": "execute_python",
                "description": "Execute Python code and return the output",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "code": {"type": "string", "description": "Python code to execute"}
                    },
                    "required": ["code"]
                }
            }
        }]

    def execute_python(self, code: str) -> str:
        """Safely execute Python code in a sandbox."""
        import subprocess
        import tempfile

        with tempfile.NamedTemporaryFile(mode='w', suffix='.py', delete=False) as f:
            f.write(code)
            f.flush()

            try:
                result = subprocess.run(
                    ['python', f.name],
                    capture_output=True,
                    text=True,
                    timeout=30
                )
                return result.stdout or result.stderr
            except subprocess.TimeoutExpired:
                return "Error: Code execution timed out"

    def run(self, task: str) -> str:
        messages = [
            {"role": "system", "content": "You can write and execute Python code to solve problems."},
            {"role": "user", "content": task}
        ]

        for _ in range(5):  # Max iterations
            response = self.client.chat.completions.create(
                model="gpt-4-turbo",
                messages=messages,
                tools=self.tools
            )

            msg = response.choices[0].message

            if not msg.tool_calls:
                return msg.content

            messages.append(msg)
            for tc in msg.tool_calls:
                args = json.loads(tc.function.arguments)
                result = self.execute_python(args["code"])
                messages.append({
                    "role": "tool",
                    "tool_call_id": tc.id,
                    "content": result
                })

        return "Task incomplete"

# Usage
agent = CodeAgent()
result = agent.run("Calculate the first 20 Fibonacci numbers")
```

---

Continue to [Exercises](/book/chapter-5/exercises).
